import{d as D,r as c,i as w,a as p,c as o,b as e,h as m,t as a,F as z,g as B,e as y,o as d,n as k,_ as V}from"./index-D7XfY-f7.js";const F=D({name:"D1AdminPanelView",setup(){const l=c([]),t=c(!0),r=c(""),u=c(null),g=s=>{if(s===0)return"0 Bytes";const i=1024,b=["Bytes","KB","MB","GB"],v=Math.floor(Math.log(s)/Math.log(i));return parseFloat((s/Math.pow(i,v)).toFixed(2))+" "+b[v]},h=s=>new Date(s).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),n=async()=>{try{t.value=!0,r.value="";const s=await p.get("https://knowledge-base-backend.leechiuhui.workers.dev/D1AdminPanel");l.value=s.data.records}catch(s){r.value=s instanceof Error?s.message:"載入資料時發生錯誤"}finally{t.value=!1}},f=async s=>{if(confirm("確定要刪除此記錄嗎？"))try{u.value=s,await p.delete(`https://knowledge-base-backend.leechiuhui.workers.dev/D1AdminPanel/${s}`),l.value=l.value.filter(i=>i.id!==s)}catch(i){r.value=i instanceof Error?i.message:"刪除記錄時發生錯誤"}finally{u.value=null}};return w(()=>{n()}),{records:l,isLoading:t,error:r,isDeletingId:u,formatFileSize:g,formatDate:h,deleteRecord:f}}}),M={class:"d1-admin-container"},$={class:"panel-section"},C={key:0,class:"loading-state"},L={key:1,class:"error-message"},P={class:"ui negative message"},S={key:2,class:"data-table"},A={class:"ui celled table"},I=["onClick"],N={key:3,class:"no-data"};function T(l,t,r,u,g,h){return d(),o("main",M,[t[7]||(t[7]=e("h1",{class:"panel-title"},"D1 資料庫管理面板",-1)),e("div",$,[t[6]||(t[6]=e("div",{class:"section-header"},[e("i",{class:"database icon"}),e("h2",null,"資料庫記錄列表")],-1)),l.isLoading?(d(),o("div",C,t[0]||(t[0]=[e("i",{class:"spinner loading icon"},null,-1),e("span",null,"正在載入資料...",-1)]))):m("",!0),l.error?(d(),o("div",L,[e("div",P,[t[1]||(t[1]=e("i",{class:"close icon"},null,-1)),t[2]||(t[2]=e("div",{class:"header"},"發生錯誤",-1)),e("p",null,a(l.error),1)])])):m("",!0),l.records.length>0?(d(),o("div",S,[e("table",A,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"檔案名稱"),e("th",null,"檔案路徑"),e("th",null,"檔案大小"),e("th",null,"檔案類型"),e("th",null,"上傳時間"),e("th",null,"向量化狀態"),e("th",null,"操作")])],-1)),e("tbody",null,[(d(!0),o(z,null,B(l.records,n=>(d(),o("tr",{key:n.id},[e("td",null,a(n.id),1),e("td",null,a(n.fileName),1),e("td",null,a(n.filePath),1),e("td",null,a(l.formatFileSize(n.fileSize)),1),e("td",null,a(n.fileType),1),e("td",null,a(l.formatDate(n.uploadTime)),1),e("td",null,[e("div",{class:k(["ui label",n.isVectorized?"green":"yellow"])},a(n.isVectorized?"已向量化":"未向量化"),3)]),e("td",null,[e("button",{class:k(["ui mini button",{loading:l.isDeletingId===n.id}]),onClick:f=>l.deleteRecord(n.id)},t[3]||(t[3]=[e("i",{class:"trash icon"},null,-1),y("刪除")]),10,I)])]))),128))])])])):l.isLoading?m("",!0):(d(),o("div",N,t[5]||(t[5]=[e("div",{class:"ui placeholder segment"},[e("div",{class:"ui icon header"},[e("i",{class:"database icon"}),y("暫無資料記錄")])],-1)])))])])}const R=V(F,[["render",T],["__scopeId","data-v-f4782017"]]);export{R as default};
