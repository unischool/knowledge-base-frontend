import{d as b,r as u,i as k,a as p,c as i,b as e,h as m,t as a,F as y,g as D,o,n as g,e as w,_ as $}from"./index-mg6Tk22T.js";const z=b({name:"D1AdminPanelView",setup(){const n=u([]),l=u(!1),d=u(""),r=u(null),f=async()=>{try{l.value=!0,d.value="";const s=await p.get("https://knowledge-base-backend.leechiuhui.workers.dev/D1AdminPanel");if(s.data.success)n.value=s.data.data;else throw new Error(s.data.message)}catch(s){console.error("載入錯誤:",s),d.value=s instanceof Error?s.message:"載入資料時發生錯誤"}finally{l.value=!1}},h=s=>s||"未知",t=s=>new Date(s).toLocaleString("zh-TW"),v=async s=>{if(confirm("確定要刪除此筆記錄嗎？")){r.value=s;try{await p.delete(`https://knowledge-base-backend.leechiuhui.workers.dev/D1AdminPanel/${s}`),n.value=n.value.filter(c=>c.id!==s)}catch(c){console.error("刪除錯誤:",c),d.value="刪除記錄時發生錯誤"}finally{r.value=null}}};return k(()=>{f()}),{records:n,isLoading:l,error:d,isDeletingId:r,formatFileSize:h,formatDate:t,deleteRecord:v}}}),C={class:"d1-admin-container"},I={class:"panel-section"},V={key:0,class:"loading-state"},A={key:1,class:"error-message"},F={class:"ui negative message"},L={key:2,class:"data-table"},P={class:"ui celled table"},S=["onClick"];function B(n,l,d,r,f,h){return o(),i("main",C,[l[6]||(l[6]=e("h1",{class:"panel-title"},"D1 資料庫管理面板",-1)),e("div",I,[l[5]||(l[5]=e("div",{class:"section-header"},[e("i",{class:"database icon"}),e("h2",null,"知識庫索引資料列表")],-1)),n.isLoading?(o(),i("div",V,l[0]||(l[0]=[e("i",{class:"spinner loading icon"},null,-1),e("span",null,"正在載入資料...",-1)]))):m("",!0),n.error?(o(),i("div",A,[e("div",F,[l[1]||(l[1]=e("i",{class:"close icon"},null,-1)),l[2]||(l[2]=e("div",{class:"header"},"發生錯誤",-1)),e("p",null,a(n.error),1)])])):m("",!0),n.records.length>0?(o(),i("div",L,[e("table",P,[l[4]||(l[4]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"向量化狀態"),e("th",null,"檔案路徑"),e("th",null,"檔案名稱"),e("th",null,"檔案大小"),e("th",null,"檔案類型"),e("th",null,"上傳時間"),e("th",null,"向量化時間"),e("th",null,"操作")])],-1)),e("tbody",null,[(o(!0),i(y,null,D(n.records,t=>(o(),i("tr",{key:t.id},[e("td",null,a(t.id),1),e("td",null,[e("div",{class:g(["ui label",t.havebeenIndexed?"green":"yellow"])},a(t.havebeenIndexed?"已向量化":"未向量化"),3)]),e("td",null,a(t.filepath),1),e("td",null,a(t.filename),1),e("td",null,a(n.formatFileSize(t.filesize)),1),e("td",null,a(t.filetype),1),e("td",null,a(n.formatDate(t.uploadeddate)),1),e("td",null,a(t.indexeddate?n.formatDate(t.indexeddate):"尚未向量化"),1),e("td",null,[e("button",{class:g(["ui mini button",{loading:n.isDeletingId===t.id}]),onClick:v=>n.deleteRecord(t.id)},l[3]||(l[3]=[e("i",{class:"trash icon"},null,-1),w("刪除")]),10,S)])]))),128))])])])):m("",!0)])])}const N=$(z,[["render",B]]);export{N as default};
