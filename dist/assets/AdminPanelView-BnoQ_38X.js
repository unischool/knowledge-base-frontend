import{d as $,r as d,a as k,c as o,b as e,w as g,v as m,f as U,e as R,F as h,g as w,t as i,h as C,i as j,o as a,_ as B}from"./index-DGOJkxYR.js";const K=$({name:"AdminPanelView",setup(){const l=d(""),s=d(""),c=d([]),f=d(!1),y=d(""),b=d([]),t=d(!1),v=d(""),I=d(""),N=d([]),V=d(!1),E=d(""),z=d(""),D=d(""),T=d([]),F=d(!1),G=d("");return{indexName:l,uploadFileName:s,uploadResult:c,isUploadLoading:f,uploadError:y,uploadToGoogleDriveReady:async()=>{var u;if(!s.value.trim()){alert("請輸入檔案名稱");return}f.value=!0,y.value="",c.value=[];try{const n=await k.get("https://knowledge-base-backend.leechiuhui.workers.dev/uploadToGoogleDriveReady/"+encodeURIComponent(s.value),{headers:{"Content-Type":"application/json"}});console.log(n),c.value=[{status:"成功",message:"檔案已上傳至準備區"}]}catch(n){console.error(n);const r=(u=n.response)==null?void 0:u.data;y.value=(r==null?void 0:r.message)||"上傳檔案時發生錯誤"}finally{f.value=!1}},result:b,isLoading:t,error:v,createIndex:async()=>{var u;if(!l.value.trim()){alert("請輸入索引名稱");return}t.value=!0,v.value="",b.value=[];try{const n=await k.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/createVectorizeIndex/"+encodeURIComponent(l.value),{headers:{"Content-Type":"application/json"}});console.log(n),b.value=[{status:"成功",message:"索引建立完成"}]}catch(n){console.error(n);const r=(u=n.response)==null?void 0:u.data;v.value=(r==null?void 0:r.message)||"建立索引時發生錯誤"}finally{t.value=!1}},deleteIndexName:I,deleteResult:N,isDeleteLoading:V,deleteError:E,deleteIndex:async()=>{var u;if(!I.value.trim()){alert("請輸入索引名稱");return}V.value=!0,E.value="",N.value=[];try{const n=await k.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/deleteVectorizeIndex/"+encodeURIComponent(I.value),{headers:{"Content-Type":"application/json"}});console.log("deleteIndex後第一次response訊息："),console.log(n),N.value=[{status:"成功",message:"索引刪除完成"}]}catch(n){console.error(n);const r=(u=n.response)==null?void 0:u.data;E.value=(r==null?void 0:r.message)||"刪除索引時發生錯誤"}finally{V.value=!1}},startNumber:z,endNumber:D,batchVectorizeResult:T,isBatchVectorizeLoading:F,batchVectorizeError:G,vectorizeR2FileRange:async()=>{var p;if(!z.value||!D.value){alert("請輸入起始和結束編號");return}const u=parseInt(z.value),n=parseInt(D.value);if(u>n){alert("起始編號不能大於結束編號");return}F.value=!0,G.value="",T.value=[];try{const r=await k.get(`https://knowledge-base-backend.leechiuhui.workers.dev/setupVectorFromR2/${u}/${n}`,{headers:{"Content-Type":"application/json"}});console.log(r),T.value=[{status:"成功",message:`已完成第 ${u} 到第 ${n} 個檔案的向量化`}]}catch(r){console.error(r);const L=(p=r.response)==null?void 0:p.data;G.value=(L==null?void 0:L.message)||"批量向量化處理時發生錯誤"}finally{F.value=!1}}}}}),A={class:"workflow-container"},P={class:"workflow-section"},S={class:"workflow-steps"},M={class:"step-card"},q={class:"step-content"},H={class:"ui form"},J={class:"field"},O={class:"upload-result"},Q={key:0,class:"loading"},W={key:1,class:"ui positive message"},X={class:"ui celled table"},Y={key:2,class:"ui negative message"},Z={class:"description"},x={class:"ui segment"},_={class:"ui input"},ee={class:"result"},se={key:0,class:"loading"},le={key:1,class:"ui positive message"},te={class:"ui celled table"},oe={key:2,class:"ui negative message"},ae={class:"description"},ne={class:"ui segment"},de={class:"ui input"},ie={class:"delete-result"},re={key:0,class:"loading"},ue={key:1,class:"ui positive message"},ve={class:"ui celled table"},pe={key:2,class:"ui negative message"},ge={class:"description"},me={class:"ui segment"},ce={class:"ui form"},fe={class:"two fields"},ye={class:"field"},be={class:"field"},ke={class:"batch-vectorize-result"},Re={key:0,class:"loading"},he={key:1,class:"ui positive message"},we={class:"ui celled table"},Ce={key:2,class:"ui negative message"},Ie={class:"description"};function Ne(l,s,c,f,y,b){return a(),o("main",A,[s[43]||(s[43]=e("h1",{class:"workflow-title"},"創源工具知識庫RAG文件處理流程",-1)),e("div",P,[s[22]||(s[22]=e("div",{class:"workflow-header"},[e("i",{class:"file archive outline icon"}),e("h2",null,"文件處理與向量化流程")],-1)),e("div",S,[e("div",M,[s[19]||(s[19]=e("div",{class:"step-number"},"01",-1)),s[20]||(s[20]=e("h3",null,"本地端/Local端文件「doc xls pdf jpg oog png wav mp3」上傳至 Google Drive",-1)),e("div",q,[s[17]||(s[17]=e("i",{class:"google drive icon"},null,-1)),s[18]||(s[18]=e("div",{class:"description"},"從本地端/Local端上傳文件到 Google Drive「準備上傳區」",-1)),e("div",H,[e("div",J,[s[13]||(s[13]=e("label",null,"選擇文件",-1)),g(e("input",{type:"text",placeholder:"請輸入檔案名稱..","onUpdate:modelValue":s[0]||(s[0]=t=>l.uploadFileName=t),onKeyup:s[1]||(s[1]=U((...t)=>l.uploadToGoogleDriveReady&&l.uploadToGoogleDriveReady(...t),["enter"]))},null,544),[[m,l.uploadFileName]]),e("button",{class:"ui primary button",onClick:s[2]||(s[2]=(...t)=>l.uploadToGoogleDriveReady&&l.uploadToGoogleDriveReady(...t))},s[12]||(s[12]=[e("i",{class:"upload icon"},null,-1),R("上傳至準備區")]))])]),e("div",O,[l.isUploadLoading?(a(),o("div",Q,"載入中，請稍候...")):l.uploadResult.length>0?(a(),o("div",W,[s[15]||(s[15]=e("h3",null,"操作結果",-1)),e("table",X,[s[14]||(s[14]=e("thead",null,[e("tr",null,[e("th",null,"檔案名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),o(h,null,w(l.uploadResult,(t,v)=>(a(),o("tr",{key:v},[e("td",null,i(l.uploadFileName),1),e("td",null,i(t.status),1),e("td",null,i(t.message),1)]))),128))])])])):l.uploadError?(a(),o("div",Y,[s[16]||(s[16]=e("h3",null,"錯誤訊息",-1)),e("div",Z,i(l.uploadError),1)])):C("",!0)])])]),s[21]||(s[21]=j('<div class="step-card" data-v-d246a974><div class="step-number" data-v-d246a974>02</div><h3 data-v-d246a974>Cloudflare R2 存儲</h3><div class="step-content" data-v-d246a974><i class="cloud upload icon" data-v-d246a974></i><div class="description" data-v-d246a974>將文件傳輸至 Cloudflare R2 存儲</div><div class="tech-tag" data-v-d246a974>main2.ts</div><ul class="step-details" data-v-d246a974><li data-v-d246a974>將文件從 Google Drive「準備上傳區」傳輸至 Cloudflare R2 存儲</li><li data-v-d246a974>記錄到「Cloudflare D1」數據庫 欄位有：是否已經向量化並進Cloudflare索引庫、文件路徑、檔案名稱、檔案綱要、檔案備註、檔案大小、檔案類型、上傳時間</li><li data-v-d246a974>移動至 Google Drive「已上傳區」進行備份</li></ul></div></div><div class="step-card" data-v-d246a974><div class="step-number" data-v-d246a974>03</div><h3 data-v-d246a974>向量化處理</h3><div class="step-content" data-v-d246a974><i class="database icon" data-v-d246a974></i><div class="description" data-v-d246a974>將 R2 文件向量化並存入 Cloudflare 索引庫</div><div class="tech-tag" data-v-d246a974>setupVectorFromR2</div><ul class="step-details" data-v-d246a974><li data-v-d246a974>select from Cloudflare D1 數據庫 欄位「是否已經向量化並進Cloudflare索引庫」 等於 false的id選出來</li><li data-v-d246a974>將 選出的id 從 Cloudflare R2 存儲庫 提取後向量化存入 Cloudflare 索引庫</li><li data-v-d246a974>更新 Cloudflare D1 數據庫 將欄位「是否已經向量化並進Cloudflare索引庫」 等於 true</li></ul></div></div>',2))])]),s[44]||(s[44]=e("h1",{class:"ui header"},"創源工具-索引建立",-1)),e("div",x,[s[27]||(s[27]=e("h2",null,"步驟一：建立向量索引",-1)),s[28]||(s[28]=e("div",{class:"ui message info"},[e("div",{class:"description"},"此步驟將建立向量索引，用於後續的文件檢索")],-1)),e("div",_,[g(e("input",{type:"text",placeholder:"請輸入索引名稱..","onUpdate:modelValue":s[3]||(s[3]=t=>l.indexName=t),onKeyup:s[4]||(s[4]=U((...t)=>l.createIndex&&l.createIndex(...t),["enter"]))},null,544),[[m,l.indexName]]),e("button",{class:"ui primary button",onClick:s[5]||(s[5]=(...t)=>l.createIndex&&l.createIndex(...t))},s[23]||(s[23]=[e("i",{class:"plus icon"},null,-1),R("建立索引")]))]),e("div",ee,[l.isLoading?(a(),o("div",se,"載入中，請稍候...")):l.result.length>0?(a(),o("div",le,[s[25]||(s[25]=e("h3",null,"操作結果",-1)),e("table",te,[s[24]||(s[24]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),o(h,null,w(l.result,(t,v)=>(a(),o("tr",{key:v},[e("td",null,i(l.indexName),1),e("td",null,i(t.status),1),e("td",null,i(t.message),1)]))),128))])])])):l.error?(a(),o("div",oe,[s[26]||(s[26]=e("h3",null,"錯誤訊息",-1)),e("div",ae,i(l.error),1)])):C("",!0)])]),e("div",ne,[s[33]||(s[33]=e("h2",null,"步驟二：刪除向量索引",-1)),s[34]||(s[34]=e("div",{class:"ui message warning"},[e("div",{class:"description"},"此步驟將刪除向量索引，請謹慎操作")],-1)),e("div",de,[g(e("input",{type:"text",placeholder:"請輸入要刪除的索引名稱..","onUpdate:modelValue":s[6]||(s[6]=t=>l.deleteIndexName=t),onKeyup:s[7]||(s[7]=U((...t)=>l.deleteIndex&&l.deleteIndex(...t),["enter"]))},null,544),[[m,l.deleteIndexName]]),e("button",{class:"ui negative button",onClick:s[8]||(s[8]=(...t)=>l.deleteIndex&&l.deleteIndex(...t))},s[29]||(s[29]=[e("i",{class:"trash icon"},null,-1),R("刪除索引")]))]),e("div",ie,[l.isDeleteLoading?(a(),o("div",re,"載入中，請稍候...")):l.deleteResult.length>0?(a(),o("div",ue,[s[31]||(s[31]=e("h3",null,"操作結果",-1)),e("table",ve,[s[30]||(s[30]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),o(h,null,w(l.deleteResult,(t,v)=>(a(),o("tr",{key:v},[e("td",null,i(l.deleteIndexName),1),e("td",null,i(t.status),1),e("td",null,i(t.message),1)]))),128))])])])):l.deleteError?(a(),o("div",pe,[s[32]||(s[32]=e("h3",null,"錯誤訊息",-1)),e("div",ge,i(l.deleteError),1)])):C("",!0)])]),e("div",me,[s[41]||(s[41]=e("h2",null,"步驟四：批量 R2 文件向量化",-1)),s[42]||(s[42]=e("div",{class:"ui message info"},[e("div",{class:"description"},"此步驟將對指定範圍內的 R2 文件進行批量向量化處理")],-1)),e("div",ce,[e("div",fe,[e("div",ye,[s[35]||(s[35]=e("label",null,"起始檔案編號",-1)),g(e("input",{type:"number",placeholder:"請輸入起始編號..","onUpdate:modelValue":s[9]||(s[9]=t=>l.startNumber=t),min:"1"},null,512),[[m,l.startNumber]])]),e("div",be,[s[36]||(s[36]=e("label",null,"結束檔案編號",-1)),g(e("input",{type:"number",placeholder:"請輸入結束編號..","onUpdate:modelValue":s[10]||(s[10]=t=>l.endNumber=t),min:"1"},null,512),[[m,l.endNumber]])])]),e("button",{class:"ui teal button",onClick:s[11]||(s[11]=(...t)=>l.vectorizeR2FileRange&&l.vectorizeR2FileRange(...t))},s[37]||(s[37]=[e("i",{class:"files icon"},null,-1),R("批量向量化")]))]),e("div",ke,[l.isBatchVectorizeLoading?(a(),o("div",Re,"載入中，請稍候...")):l.batchVectorizeResult.length>0?(a(),o("div",he,[s[39]||(s[39]=e("h3",null,"操作結果",-1)),e("table",we,[s[38]||(s[38]=e("thead",null,[e("tr",null,[e("th",null,"處理範圍"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),o(h,null,w(l.batchVectorizeResult,(t,v)=>(a(),o("tr",{key:v},[e("td",null,i(l.startNumber)+" - "+i(l.endNumber),1),e("td",null,i(t.status),1),e("td",null,i(t.message),1)]))),128))])])])):l.batchVectorizeError?(a(),o("div",Ce,[s[40]||(s[40]=e("h3",null,"錯誤訊息",-1)),e("div",Ie,i(l.batchVectorizeError),1)])):C("",!0)])])])}const Ge=B(K,[["render",Ne],["__scopeId","data-v-d246a974"]]);export{Ge as default};
