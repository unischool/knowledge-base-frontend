import{d as L,r as i,a as w,c as n,b as e,w as f,v as h,f as F,e as E,F as k,g as C,t as u,h as $,o,_ as U}from"./index-Bk6_IT5a.js";const B=L({name:"AdminPanelView",setup(){const t=i(""),s=i([]),v=i(!1),m=i(""),g=i(""),b=i([]),l=i(!1),d=i(""),I=i(""),V=i(""),c=i([]),N=i(!1),R=i("");return{indexName:t,result:s,isLoading:v,error:m,createIndex:async()=>{var p;if(!t.value.trim()){alert("請輸入索引名稱");return}v.value=!0,m.value="",s.value=[];try{const r=await w.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/createVectorizeIndex/"+encodeURIComponent(t.value),{headers:{"Content-Type":"application/json"}});console.log(r),s.value=[{status:"成功",message:"索引建立完成"}]}catch(r){console.error(r);const a=(p=r.response)==null?void 0:p.data;m.value=(a==null?void 0:a.message)||"建立索引時發生錯誤"}finally{v.value=!1}},deleteIndexName:g,deleteResult:b,isDeleteLoading:l,deleteError:d,deleteIndex:async()=>{var p;if(!g.value.trim()){alert("請輸入索引名稱");return}l.value=!0,d.value="",b.value=[];try{const r=await w.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/deleteVectorizeIndex/"+encodeURIComponent(g.value),{headers:{"Content-Type":"application/json"}});console.log("deleteIndex後第一次response訊息："),console.log(r),b.value=[{status:"成功",message:"索引刪除完成"}]}catch(r){console.error(r);const a=(p=r.response)==null?void 0:p.data;d.value=(a==null?void 0:a.message)||"刪除索引時發生錯誤"}finally{l.value=!1}},startNumber:I,endNumber:V,batchVectorizeResult:c,isBatchVectorizeLoading:N,batchVectorizeError:R,vectorizeR2FileRange:async()=>{var y;if(!I.value||!V.value){alert("請輸入起始和結束編號");return}const p=parseInt(I.value),r=parseInt(V.value);if(p>r){alert("起始編號不能大於結束編號");return}N.value=!0,R.value="",c.value=[];try{const a=await w.get(`https://knowledge-base-backend.leechiuhui.workers.dev/setupVectorFromR2/${p}/${r}`,{headers:{"Content-Type":"application/json"}});console.log(a),c.value=[{status:"成功",message:`已完成第 ${p} 到第 ${r} 個檔案的向量化`}]}catch(a){console.error(a);const z=(y=a.response)==null?void 0:y.data;R.value=(z==null?void 0:z.message)||"批量向量化處理時發生錯誤"}finally{N.value=!1}}}}}),T={class:"ui segment"},j={class:"ui input"},K={class:"result"},A={key:0},P={key:1,class:"ui positive message"},D={class:"ui celled table"},M={key:2},S={class:"ui negative message"},q={class:"ui segment"},x={class:"ui input"},G={class:"delete-result"},H={key:0},J={key:1,class:"ui positive message"},O={class:"ui celled table"},Q={key:2},W={class:"ui negative message"},X={class:"ui segment"},Y={class:"ui form"},Z={class:"two fields"},_={class:"field"},ee={class:"field"},se={class:"batch-vectorize-result"},te={key:0},le={key:1,class:"ui positive message"},ne={class:"ui celled table"},oe={key:2},re={class:"ui negative message"};function ie(t,s,v,m,g,b){return o(),n(k,null,[e("main",null,[s[15]||(s[15]=e("h1",{class:"ui header"},"創源工具-索引建立",-1)),e("div",T,[s[13]||(s[13]=e("h2",null,"步驟一：建立向量索引",-1)),s[14]||(s[14]=e("div",{class:"ui message info"},[e("p",null,"此步驟將建立向量索引，用於後續的文件檢索")],-1)),e("div",j,[f(e("input",{type:"text",placeholder:"請輸入索引名稱..","onUpdate:modelValue":s[0]||(s[0]=l=>t.indexName=l),onKeyup:s[1]||(s[1]=F((...l)=>t.createIndex&&t.createIndex(...l),["enter"]))},null,544),[[h,t.indexName]]),e("button",{class:"ui primary button",onClick:s[2]||(s[2]=(...l)=>t.createIndex&&t.createIndex(...l))},s[9]||(s[9]=[e("i",{class:"plus icon"},null,-1),E("建立索引")]))]),e("div",K,[t.isLoading?(o(),n("p",A,"載入中，請稍候...")):t.result.length>0?(o(),n("div",P,[s[11]||(s[11]=e("h3",null,"操作結果",-1)),e("table",D,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(o(!0),n(k,null,C(t.result,(l,d)=>(o(),n("tr",{key:d},[e("td",null,u(t.indexName),1),e("td",null,u(l.status),1),e("td",null,u(l.message),1)]))),128))])])])):t.error?(o(),n("p",M,[e("div",S,[s[12]||(s[12]=e("h3",null,"錯誤訊息",-1)),e("p",null,u(t.error),1)])])):$("",!0)])])]),e("div",q,[s[20]||(s[20]=e("h2",null,"步驟二：刪除向量索引",-1)),s[21]||(s[21]=e("div",{class:"ui message warning"},[e("p",null,"此步驟將刪除向量索引，請謹慎操作")],-1)),e("div",x,[f(e("input",{type:"text",placeholder:"請輸入要刪除的索引名稱..","onUpdate:modelValue":s[3]||(s[3]=l=>t.deleteIndexName=l),onKeyup:s[4]||(s[4]=F((...l)=>t.deleteIndex&&t.deleteIndex(...l),["enter"]))},null,544),[[h,t.deleteIndexName]]),e("button",{class:"ui negative button",onClick:s[5]||(s[5]=(...l)=>t.deleteIndex&&t.deleteIndex(...l))},s[16]||(s[16]=[e("i",{class:"trash icon"},null,-1),E("刪除索引")]))]),e("div",G,[t.isDeleteLoading?(o(),n("p",H,"載入中，請稍候...")):t.deleteResult.length>0?(o(),n("div",J,[s[18]||(s[18]=e("h3",null,"操作結果",-1)),e("table",O,[s[17]||(s[17]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(o(!0),n(k,null,C(t.deleteResult,(l,d)=>(o(),n("tr",{key:d},[e("td",null,u(t.deleteIndexName),1),e("td",null,u(l.status),1),e("td",null,u(l.message),1)]))),128))])])])):t.deleteError?(o(),n("p",Q,[e("div",W,[s[19]||(s[19]=e("h3",null,"錯誤訊息",-1)),e("p",null,u(t.deleteError),1)])])):$("",!0)])]),e("div",X,[s[28]||(s[28]=e("h2",null,"步驟四：批量 R2 文件向量化",-1)),s[29]||(s[29]=e("div",{class:"ui message info"},[e("p",null,"此步驟將對指定範圍內的 R2 文件進行批量向量化處理")],-1)),e("div",Y,[e("div",Z,[e("div",_,[s[22]||(s[22]=e("label",null,"起始檔案編號",-1)),f(e("input",{type:"number",placeholder:"請輸入起始編號..","onUpdate:modelValue":s[6]||(s[6]=l=>t.startNumber=l),min:"1"},null,512),[[h,t.startNumber]])]),e("div",ee,[s[23]||(s[23]=e("label",null,"結束檔案編號",-1)),f(e("input",{type:"number",placeholder:"請輸入結束編號..","onUpdate:modelValue":s[7]||(s[7]=l=>t.endNumber=l),min:"1"},null,512),[[h,t.endNumber]])])]),e("button",{class:"ui teal button",onClick:s[8]||(s[8]=(...l)=>t.vectorizeR2FileRange&&t.vectorizeR2FileRange(...l))},s[24]||(s[24]=[e("i",{class:"files icon"},null,-1),E("批量向量化")]))]),e("div",se,[t.isBatchVectorizeLoading?(o(),n("p",te,"載入中，請稍候...")):t.batchVectorizeResult.length>0?(o(),n("div",le,[s[26]||(s[26]=e("h3",null,"操作結果",-1)),e("table",ne,[s[25]||(s[25]=e("thead",null,[e("tr",null,[e("th",null,"處理範圍"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(o(!0),n(k,null,C(t.batchVectorizeResult,(l,d)=>(o(),n("tr",{key:d},[e("td",null,u(t.startNumber)+" - "+u(t.endNumber),1),e("td",null,u(l.status),1),e("td",null,u(l.message),1)]))),128))])])])):t.batchVectorizeError?(o(),n("p",oe,[e("div",re,[s[27]||(s[27]=e("h3",null,"錯誤訊息",-1)),e("p",null,u(t.batchVectorizeError),1)])])):$("",!0)])])],64)}const me=U(B,[["render",ie],["__scopeId","data-v-b62b5728"]]);export{me as default};
