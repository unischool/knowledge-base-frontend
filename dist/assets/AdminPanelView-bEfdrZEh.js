import{d as F,r as i,a as N,c as a,b as e,h as $,w as g,v as h,f as D,e as z,F as y,g as E,t as d,i as L,o as n,_ as U}from"./index-syYeTvT0.js";const B=F({name:"AdminPanelView",setup(){const s=i(""),l=i([]),c=i(!1),p=i(""),f=i(""),b=i([]),t=i(!1),u=i(""),k=i(""),w=i(""),R=i([]),I=i(!1),C=i("");return{indexName:s,result:l,isLoading:c,error:p,createIndex:async()=>{var v;if(!s.value.trim()){alert("請輸入索引名稱");return}c.value=!0,p.value="",l.value=[];try{const o=await N.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/createVectorizeIndex/"+encodeURIComponent(s.value),{headers:{"Content-Type":"application/json"}});console.log(o),l.value=[{status:"成功",message:"索引建立完成"}]}catch(o){console.error(o);const r=(v=o.response)==null?void 0:v.data;p.value=(r==null?void 0:r.message)||"建立索引時發生錯誤"}finally{c.value=!1}},deleteIndexName:f,deleteResult:b,isDeleteLoading:t,deleteError:u,deleteIndex:async()=>{var v;if(!f.value.trim()){alert("請輸入索引名稱");return}t.value=!0,u.value="",b.value=[];try{const o=await N.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/deleteVectorizeIndex/"+encodeURIComponent(f.value),{headers:{"Content-Type":"application/json"}});console.log("deleteIndex後第一次response訊息："),console.log(o),b.value=[{status:"成功",message:"索引刪除完成"}]}catch(o){console.error(o);const r=(v=o.response)==null?void 0:v.data;u.value=(r==null?void 0:r.message)||"刪除索引時發生錯誤"}finally{t.value=!1}},startNumber:k,endNumber:w,batchVectorizeResult:R,isBatchVectorizeLoading:I,batchVectorizeError:C,vectorizeR2FileRange:async()=>{var m;if(!k.value||!w.value){alert("請輸入起始和結束編號");return}const v=parseInt(k.value),o=parseInt(w.value);if(v>o){alert("起始編號不能大於結束編號");return}I.value=!0,C.value="",R.value=[];try{const r=await N.get(`https://knowledge-base-backend.leechiuhui.workers.dev/setupVectorFromR2/${v}/${o}`,{headers:{"Content-Type":"application/json"}});console.log(r),R.value=[{status:"成功",message:`已完成第 ${v} 到第 ${o} 個檔案的向量化`}]}catch(r){console.error(r);const V=(m=r.response)==null?void 0:m.data;C.value=(V==null?void 0:V.message)||"批量向量化處理時發生錯誤"}finally{I.value=!1}}}}}),G={class:"workflow-container"},T={class:"ui segment"},j={class:"ui input"},A={class:"result"},K={key:0},P={key:1,class:"ui positive message"},S={class:"ui celled table"},x={key:2},M={class:"ui negative message"},q={class:"ui segment"},H={class:"ui input"},J={class:"delete-result"},O={key:0},Q={key:1,class:"ui positive message"},W={class:"ui celled table"},X={key:2},Y={class:"ui negative message"},Z={class:"ui segment"},_={class:"ui form"},ee={class:"two fields"},le={class:"field"},se={class:"field"},te={class:"batch-vectorize-result"},ae={key:0},ne={key:1,class:"ui positive message"},oe={class:"ui celled table"},ie={key:2},de={class:"ui negative message"};function re(s,l,c,p,f,b){return n(),a(y,null,[l[30]||(l[30]=e("main",null,null,-1)),e("main",G,[l[15]||(l[15]=$('<h1 class="workflow-title" data-v-b53fc9a3>創源工具知識庫RAG文件處理流程</h1><div class="workflow-section" data-v-b53fc9a3><div class="workflow-header" data-v-b53fc9a3><i class="file archive outline icon" data-v-b53fc9a3></i><h2 data-v-b53fc9a3>文件處理與向量化流程</h2></div><div class="workflow-steps" data-v-b53fc9a3><div class="step-card" data-v-b53fc9a3><div class="step-number" data-v-b53fc9a3>01</div><h3 data-v-b53fc9a3>本地端/Local端文件「doc xls pdf jpg oog png wav mp3」上傳至 Google Drive</h3><div class="step-content" data-v-b53fc9a3><i class="google drive icon" data-v-b53fc9a3></i><p data-v-b53fc9a3>從本地端/Local端上傳文件到 Google Drive「準備上傳區」</p></div></div><div class="step-card" data-v-b53fc9a3><div class="step-number" data-v-b53fc9a3>02</div><h3 data-v-b53fc9a3>Cloudflare R2 存儲</h3><div class="step-content" data-v-b53fc9a3><i class="cloud upload icon" data-v-b53fc9a3></i><p data-v-b53fc9a3>將文件傳輸至 Cloudflare R2 存儲</p><div class="tech-tag" data-v-b53fc9a3>main2.ts</div><ul class="step-details" data-v-b53fc9a3><li data-v-b53fc9a3>將文件從 Google Drive「準備上傳區」傳輸至 Cloudflare R2 存儲</li><li data-v-b53fc9a3>記錄到「Cloudflare D1」數據庫 欄位有：是否已經向量化並進Cloudflare索引庫、文件路徑、檔案名稱、檔案綱要、檔案備註、檔案大小、檔案類型、上傳時間</li><li data-v-b53fc9a3>移動至 Google Drive「已上傳區」進行備份</li></ul></div></div><div class="step-card" data-v-b53fc9a3><div class="step-number" data-v-b53fc9a3>03</div><h3 data-v-b53fc9a3>向量化處理</h3><div class="step-content" data-v-b53fc9a3><i class="database icon" data-v-b53fc9a3></i><p data-v-b53fc9a3>將 R2 文件向量化並存入 Cloudflare 索引庫</p><div class="tech-tag" data-v-b53fc9a3>setupVectorFromR2</div><ul class="step-details" data-v-b53fc9a3><li data-v-b53fc9a3>select from Cloudflare D1 數據庫 欄位「是否已經向量化並進Cloudflare索引庫」 等於 false的id選出來</li><li data-v-b53fc9a3>將 選出的id 從 Cloudflare R2 存儲庫 提取後向量化存入 Cloudflare 索引庫</li><li data-v-b53fc9a3>更新 Cloudflare D1 數據庫 將欄位「是否已經向量化並進Cloudflare索引庫」 等於 true</li></ul></div></div></div></div><h1 class="ui header" data-v-b53fc9a3>創源工具-索引建立</h1>',3)),e("div",T,[l[13]||(l[13]=e("h2",null,"步驟一：建立向量索引",-1)),l[14]||(l[14]=e("div",{class:"ui message info"},[e("p",null,"此步驟將建立向量索引，用於後續的文件檢索")],-1)),e("div",j,[g(e("input",{type:"text",placeholder:"請輸入索引名稱..","onUpdate:modelValue":l[0]||(l[0]=t=>s.indexName=t),onKeyup:l[1]||(l[1]=D((...t)=>s.createIndex&&s.createIndex(...t),["enter"]))},null,544),[[h,s.indexName]]),e("button",{class:"ui primary button",onClick:l[2]||(l[2]=(...t)=>s.createIndex&&s.createIndex(...t))},l[9]||(l[9]=[e("i",{class:"plus icon"},null,-1),z("建立索引")]))]),e("div",A,[s.isLoading?(n(),a("p",K,"載入中，請稍候...")):s.result.length>0?(n(),a("div",P,[l[11]||(l[11]=e("h3",null,"操作結果",-1)),e("table",S,[l[10]||(l[10]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(n(!0),a(y,null,E(s.result,(t,u)=>(n(),a("tr",{key:u},[e("td",null,d(s.indexName),1),e("td",null,d(t.status),1),e("td",null,d(t.message),1)]))),128))])])])):s.error?(n(),a("p",x,[e("div",M,[l[12]||(l[12]=e("h3",null,"錯誤訊息",-1)),e("p",null,d(s.error),1)])])):L("",!0)])])]),e("div",q,[l[20]||(l[20]=e("h2",null,"步驟二：刪除向量索引",-1)),l[21]||(l[21]=e("div",{class:"ui message warning"},[e("p",null,"此步驟將刪除向量索引，請謹慎操作")],-1)),e("div",H,[g(e("input",{type:"text",placeholder:"請輸入要刪除的索引名稱..","onUpdate:modelValue":l[3]||(l[3]=t=>s.deleteIndexName=t),onKeyup:l[4]||(l[4]=D((...t)=>s.deleteIndex&&s.deleteIndex(...t),["enter"]))},null,544),[[h,s.deleteIndexName]]),e("button",{class:"ui negative button",onClick:l[5]||(l[5]=(...t)=>s.deleteIndex&&s.deleteIndex(...t))},l[16]||(l[16]=[e("i",{class:"trash icon"},null,-1),z("刪除索引")]))]),e("div",J,[s.isDeleteLoading?(n(),a("p",O,"載入中，請稍候...")):s.deleteResult.length>0?(n(),a("div",Q,[l[18]||(l[18]=e("h3",null,"操作結果",-1)),e("table",W,[l[17]||(l[17]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(n(!0),a(y,null,E(s.deleteResult,(t,u)=>(n(),a("tr",{key:u},[e("td",null,d(s.deleteIndexName),1),e("td",null,d(t.status),1),e("td",null,d(t.message),1)]))),128))])])])):s.deleteError?(n(),a("p",X,[e("div",Y,[l[19]||(l[19]=e("h3",null,"錯誤訊息",-1)),e("p",null,d(s.deleteError),1)])])):L("",!0)])]),e("div",Z,[l[28]||(l[28]=e("h2",null,"步驟四：批量 R2 文件向量化",-1)),l[29]||(l[29]=e("div",{class:"ui message info"},[e("p",null,"此步驟將對指定範圍內的 R2 文件進行批量向量化處理")],-1)),e("div",_,[e("div",ee,[e("div",le,[l[22]||(l[22]=e("label",null,"起始檔案編號",-1)),g(e("input",{type:"number",placeholder:"請輸入起始編號..","onUpdate:modelValue":l[6]||(l[6]=t=>s.startNumber=t),min:"1"},null,512),[[h,s.startNumber]])]),e("div",se,[l[23]||(l[23]=e("label",null,"結束檔案編號",-1)),g(e("input",{type:"number",placeholder:"請輸入結束編號..","onUpdate:modelValue":l[7]||(l[7]=t=>s.endNumber=t),min:"1"},null,512),[[h,s.endNumber]])])]),e("button",{class:"ui teal button",onClick:l[8]||(l[8]=(...t)=>s.vectorizeR2FileRange&&s.vectorizeR2FileRange(...t))},l[24]||(l[24]=[e("i",{class:"files icon"},null,-1),z("批量向量化")]))]),e("div",te,[s.isBatchVectorizeLoading?(n(),a("p",ae,"載入中，請稍候...")):s.batchVectorizeResult.length>0?(n(),a("div",ne,[l[26]||(l[26]=e("h3",null,"操作結果",-1)),e("table",oe,[l[25]||(l[25]=e("thead",null,[e("tr",null,[e("th",null,"處理範圍"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(n(!0),a(y,null,E(s.batchVectorizeResult,(t,u)=>(n(),a("tr",{key:u},[e("td",null,d(s.startNumber)+" - "+d(s.endNumber),1),e("td",null,d(t.status),1),e("td",null,d(t.message),1)]))),128))])])])):s.batchVectorizeError?(n(),a("p",ie,[e("div",de,[l[27]||(l[27]=e("h3",null,"錯誤訊息",-1)),e("p",null,d(s.batchVectorizeError),1)])])):L("",!0)])])],64)}const be=U(B,[["render",re],["__scopeId","data-v-b53fc9a3"]]);export{be as default};
