import{d as h,b as c,c as l,a as s,h as u,w as p,v as g,e as m,g as d,F as f,f as y,o as n,t as k,_ as b}from"./index-BDVitznL.js";const v=h({name:"FullTextSearchView",data(){return{searchQuery:"",isLoading:!1,afterSearch:!1,searchResults:[]}},methods:{search(){if(!this.searchQuery.trim()){alert("請輸入搜尋關鍵字");return}this.isLoading=!0,c.get("https://knowledge-base-backend.leechiuhui.workers.dev/api/search/"+encodeURIComponent(this.searchQuery)).then(e=>{this.searchResults=e.data,this.isLoading=!1,this.afterSearch=!0}).catch(e=>{console.error(e),this.isLoading=!1,this.afterSearch=!1})},goToResult(e){const t="https://knowledge-base-backend.leechiuhui.workers.dev/api/download/"+e;window.open(t,"_blank")},escapeHtml(e){return(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},highlightKeyword(e){if(!this.searchQuery)return this.escapeHtml(e);const t=this.escapeHtml(e),i=this.escapeHtml(this.searchQuery),o=new RegExp(i,"gi");return t.replace(o,r=>`<mark>${r}</mark>`)}}}),w={class:"ui container"},L={key:0,class:"ui active dimmer"},T={class:"ui segment color-block",style:{"background-color":"#FFD966"}},Q={class:"ui input-area"},R={class:"ui input"},H={key:1,class:"ui segment color-block",style:{"background-color":"#A9D08E","margin-top":"20px"}},C={class:"ui stackable celled table"},S=["innerHTML"],F=["innerHTML"],V={class:"actions"},$=["onClick"],K={key:2};function M(e,t,i,o,r,D){return n(),l("div",w,[e.isLoading?(n(),l("div",L,t[3]||(t[3]=[s("div",{class:"ui text loader"},"搜尋中...",-1)]))):u("",!0),s("div",T,[t[5]||(t[5]=s("h1",null,"全文檢索 - 創源工具",-1)),s("div",Q,[s("div",R,[p(s("input",{type:"text",autofocus:"","onUpdate:modelValue":t[0]||(t[0]=a=>e.searchQuery=a),placeholder:"請輸入搜尋關鍵字...",onKeyup:t[1]||(t[1]=m((...a)=>e.search&&e.search(...a),["enter"]))},null,544),[[g,e.searchQuery]])]),s("button",{class:"ui button primary",onClick:t[2]||(t[2]=(...a)=>e.search&&e.search(...a))},t[4]||(t[4]=[s("i",{class:"search icon"},null,-1),d("搜尋")]))])]),e.searchResults.length>0?(n(),l("div",H,[t[8]||(t[8]=s("h2",null,"查詢結果",-1)),s("table",C,[t[7]||(t[7]=s("thead",null,[s("tr",null,[s("th",null,"檔案名稱"),s("th",null,"大綱"),s("th",null,"內文"),s("th",{class:"actions"},"操作")])],-1)),s("tbody",null,[(n(!0),l(f,null,y(e.searchResults,a=>(n(),l("tr",{key:a.filename},[s("td",null,[s("div",null,k(a.filename),1)]),s("td",null,[s("div",{innerHTML:e.highlightKeyword(a.fileoutline)},null,8,S)]),s("td",null,[s("div",{innerHTML:e.highlightKeyword(a.content)},null,8,F)]),s("td",V,[s("button",{class:"ui primary button",onClick:B=>e.goToResult(a.filename)},t[6]||(t[6]=[s("i",{class:"download icon"},null,-1),d("下載檔案")]),8,$)])]))),128))])])])):!e.isLoading&&e.afterSearch&&e.searchResults.length===0&&e.searchQuery.trim()!==""?(n(),l("p",K,"未找到相關結果")):u("",!0)])}const N=b(v,[["render",M],["__scopeId","data-v-1fa89c82"]]);export{N as default};
