import{d as L,r as o,a as z,c as n,b as e,h as U,w as h,v as y,f as $,e as E,F as f,g as C,t as i,i as F,o as a,_ as B}from"./index-DE-yInlc.js";const T=L({name:"AdminPanelView",setup(){const t=o(""),s=o([]),b=o(!1),p=o(""),m=o(""),g=o([]),l=o(!1),u=o(""),k=o(""),w=o(""),I=o([]),R=o(!1),V=o("");return{indexName:t,result:s,isLoading:b,error:p,createIndex:async()=>{var v;if(!t.value.trim()){alert("請輸入索引名稱");return}b.value=!0,p.value="",s.value=[];try{const d=await z.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/createVectorizeIndex/"+encodeURIComponent(t.value),{headers:{"Content-Type":"application/json"}});console.log(d),s.value=[{status:"成功",message:"索引建立完成"}]}catch(d){console.error(d);const r=(v=d.response)==null?void 0:v.data;p.value=(r==null?void 0:r.message)||"建立索引時發生錯誤"}finally{b.value=!1}},deleteIndexName:m,deleteResult:g,isDeleteLoading:l,deleteError:u,deleteIndex:async()=>{var v;if(!m.value.trim()){alert("請輸入索引名稱");return}l.value=!0,u.value="",g.value=[];try{const d=await z.get("https://knowledge-base-backend.leechiuhui.workers.dev/vectorize/deleteVectorizeIndex/"+encodeURIComponent(m.value),{headers:{"Content-Type":"application/json"}});console.log("deleteIndex後第一次response訊息："),console.log(d),g.value=[{status:"成功",message:"索引刪除完成"}]}catch(d){console.error(d);const r=(v=d.response)==null?void 0:v.data;u.value=(r==null?void 0:r.message)||"刪除索引時發生錯誤"}finally{l.value=!1}},startNumber:k,endNumber:w,batchVectorizeResult:I,isBatchVectorizeLoading:R,batchVectorizeError:V,vectorizeR2FileRange:async()=>{var c;if(!k.value||!w.value){alert("請輸入起始和結束編號");return}const v=parseInt(k.value),d=parseInt(w.value);if(v>d){alert("起始編號不能大於結束編號");return}R.value=!0,V.value="",I.value=[];try{const r=await z.get(`https://knowledge-base-backend.leechiuhui.workers.dev/setupVectorFromR2/${v}/${d}`,{headers:{"Content-Type":"application/json"}});console.log(r),I.value=[{status:"成功",message:`已完成第 ${v} 到第 ${d} 個檔案的向量化`}]}catch(r){console.error(r);const N=(c=r.response)==null?void 0:c.data;V.value=(N==null?void 0:N.message)||"批量向量化處理時發生錯誤"}finally{R.value=!1}}}}}),j={class:"workflow-container"},A={class:"ui segment"},D={class:"ui input"},K={class:"result"},G={key:0},P={key:1,class:"ui positive message"},S={class:"ui celled table"},M={key:2},q={class:"ui negative message"},x={class:"ui segment"},H={class:"ui input"},J={class:"delete-result"},O={key:0},Q={key:1,class:"ui positive message"},W={class:"ui celled table"},X={key:2},Y={class:"ui negative message"},Z={class:"ui segment"},_={class:"ui form"},ee={class:"two fields"},se={class:"field"},te={class:"field"},le={class:"batch-vectorize-result"},ne={key:0},ae={key:1,class:"ui positive message"},de={class:"ui celled table"},oe={key:2},ie={class:"ui negative message"};function re(t,s,b,p,m,g){return a(),n(f,null,[s[30]||(s[30]=e("main",null,null,-1)),e("main",j,[s[15]||(s[15]=U('<h1 class="workflow-title" data-v-ed5b255b>知識庫RAG文件處理流程</h1><div class="workflow-section" data-v-ed5b255b><div class="workflow-header" data-v-ed5b255b><i class="file archive outline icon" data-v-ed5b255b></i><h2 data-v-ed5b255b>文件處理與向量化流程</h2></div><div class="workflow-steps" data-v-ed5b255b><div class="step-card" data-v-ed5b255b><div class="step-number" data-v-ed5b255b>01</div><h3 data-v-ed5b255b>文件上傳與備份</h3><div class="step-content" data-v-ed5b255b><i class="google drive icon" data-v-ed5b255b></i><p data-v-ed5b255b>從本地端上傳文件到 Google Drive</p><ul class="step-details" data-v-ed5b255b><li data-v-ed5b255b>上傳至「準備上傳區」資料夾</li><li data-v-ed5b255b>記錄到「D1」數據庫</li><li data-v-ed5b255b>移動至「已上傳區」進行備份</li></ul></div></div><div class="step-card" data-v-ed5b255b><div class="step-number" data-v-ed5b255b>02</div><h3 data-v-ed5b255b>R2 存儲</h3><div class="step-content" data-v-ed5b255b><i class="cloud upload icon" data-v-ed5b255b></i><p data-v-ed5b255b>將文件傳輸至 R2 存儲</p><div class="tech-tag" data-v-ed5b255b>main2.ts</div></div></div><div class="step-card" data-v-ed5b255b><div class="step-number" data-v-ed5b255b>03</div><h3 data-v-ed5b255b>向量化處理</h3><div class="step-content" data-v-ed5b255b><i class="database icon" data-v-ed5b255b></i><p data-v-ed5b255b>將 R2 文件向量化並存入 Cloudflare 索引庫</p><div class="tech-tag" data-v-ed5b255b>setupVectorFromR2</div></div></div></div></div><h1 class="ui header" data-v-ed5b255b>創源工具-索引建立</h1>',3)),e("div",A,[s[13]||(s[13]=e("h2",null,"步驟一：建立向量索引",-1)),s[14]||(s[14]=e("div",{class:"ui message info"},[e("p",null,"此步驟將建立向量索引，用於後續的文件檢索")],-1)),e("div",D,[h(e("input",{type:"text",placeholder:"請輸入索引名稱..","onUpdate:modelValue":s[0]||(s[0]=l=>t.indexName=l),onKeyup:s[1]||(s[1]=$((...l)=>t.createIndex&&t.createIndex(...l),["enter"]))},null,544),[[y,t.indexName]]),e("button",{class:"ui primary button",onClick:s[2]||(s[2]=(...l)=>t.createIndex&&t.createIndex(...l))},s[9]||(s[9]=[e("i",{class:"plus icon"},null,-1),E("建立索引")]))]),e("div",K,[t.isLoading?(a(),n("p",G,"載入中，請稍候...")):t.result.length>0?(a(),n("div",P,[s[11]||(s[11]=e("h3",null,"操作結果",-1)),e("table",S,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),n(f,null,C(t.result,(l,u)=>(a(),n("tr",{key:u},[e("td",null,i(t.indexName),1),e("td",null,i(l.status),1),e("td",null,i(l.message),1)]))),128))])])])):t.error?(a(),n("p",M,[e("div",q,[s[12]||(s[12]=e("h3",null,"錯誤訊息",-1)),e("p",null,i(t.error),1)])])):F("",!0)])])]),e("div",x,[s[20]||(s[20]=e("h2",null,"步驟二：刪除向量索引",-1)),s[21]||(s[21]=e("div",{class:"ui message warning"},[e("p",null,"此步驟將刪除向量索引，請謹慎操作")],-1)),e("div",H,[h(e("input",{type:"text",placeholder:"請輸入要刪除的索引名稱..","onUpdate:modelValue":s[3]||(s[3]=l=>t.deleteIndexName=l),onKeyup:s[4]||(s[4]=$((...l)=>t.deleteIndex&&t.deleteIndex(...l),["enter"]))},null,544),[[y,t.deleteIndexName]]),e("button",{class:"ui negative button",onClick:s[5]||(s[5]=(...l)=>t.deleteIndex&&t.deleteIndex(...l))},s[16]||(s[16]=[e("i",{class:"trash icon"},null,-1),E("刪除索引")]))]),e("div",J,[t.isDeleteLoading?(a(),n("p",O,"載入中，請稍候...")):t.deleteResult.length>0?(a(),n("div",Q,[s[18]||(s[18]=e("h3",null,"操作結果",-1)),e("table",W,[s[17]||(s[17]=e("thead",null,[e("tr",null,[e("th",null,"索引名稱"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),n(f,null,C(t.deleteResult,(l,u)=>(a(),n("tr",{key:u},[e("td",null,i(t.deleteIndexName),1),e("td",null,i(l.status),1),e("td",null,i(l.message),1)]))),128))])])])):t.deleteError?(a(),n("p",X,[e("div",Y,[s[19]||(s[19]=e("h3",null,"錯誤訊息",-1)),e("p",null,i(t.deleteError),1)])])):F("",!0)])]),e("div",Z,[s[28]||(s[28]=e("h2",null,"步驟四：批量 R2 文件向量化",-1)),s[29]||(s[29]=e("div",{class:"ui message info"},[e("p",null,"此步驟將對指定範圍內的 R2 文件進行批量向量化處理")],-1)),e("div",_,[e("div",ee,[e("div",se,[s[22]||(s[22]=e("label",null,"起始檔案編號",-1)),h(e("input",{type:"number",placeholder:"請輸入起始編號..","onUpdate:modelValue":s[6]||(s[6]=l=>t.startNumber=l),min:"1"},null,512),[[y,t.startNumber]])]),e("div",te,[s[23]||(s[23]=e("label",null,"結束檔案編號",-1)),h(e("input",{type:"number",placeholder:"請輸入結束編號..","onUpdate:modelValue":s[7]||(s[7]=l=>t.endNumber=l),min:"1"},null,512),[[y,t.endNumber]])])]),e("button",{class:"ui teal button",onClick:s[8]||(s[8]=(...l)=>t.vectorizeR2FileRange&&t.vectorizeR2FileRange(...l))},s[24]||(s[24]=[e("i",{class:"files icon"},null,-1),E("批量向量化")]))]),e("div",le,[t.isBatchVectorizeLoading?(a(),n("p",ne,"載入中，請稍候...")):t.batchVectorizeResult.length>0?(a(),n("div",ae,[s[26]||(s[26]=e("h3",null,"操作結果",-1)),e("table",de,[s[25]||(s[25]=e("thead",null,[e("tr",null,[e("th",null,"處理範圍"),e("th",null,"狀態"),e("th",null,"訊息")])],-1)),e("tbody",null,[(a(!0),n(f,null,C(t.batchVectorizeResult,(l,u)=>(a(),n("tr",{key:u},[e("td",null,i(t.startNumber)+" - "+i(t.endNumber),1),e("td",null,i(l.status),1),e("td",null,i(l.message),1)]))),128))])])])):t.batchVectorizeError?(a(),n("p",oe,[e("div",ie,[s[27]||(s[27]=e("h3",null,"錯誤訊息",-1)),e("p",null,i(t.batchVectorizeError),1)])])):F("",!0)])])],64)}const ge=B(T,[["render",re],["__scopeId","data-v-ed5b255b"]]);export{ge as default};
